[2019-01-16 10:50:59][INFO] horae.py(41): topic projects/pchomeecvenraas/topics/bucket_ven-custs has already existed.
[2019-01-16 10:50:59][INFO] horae.py(41): topic projects/pchomeecvenraas/topics/bigquery has already existed.
[2019-01-16 10:50:59][INFO] horae.py(41): topic projects/pchomeecvenraas/topics/es-cluster has already existed.
[2019-01-16 10:51:01][INFO] horae.py(60): subscription projects/pchomeecvenraas/subscriptions/pull_bucket_ven-custs has already existed.
[2019-01-16 10:51:01][INFO] horae.py(60): subscription projects/pchomeecvenraas/subscriptions/pull_bigquery has already existed.
[2019-01-16 10:51:01][INFO] horae.py(60): subscription projects/pchomeecvenraas/subscriptions/pull_es-cluster has already existed.
[2019-01-16 10:51:01][INFO] horae.py(88): Loaded module: ImportGOCC2es
[2019-01-16 10:51:01][INFO] horae.py(88): Loaded module: ESAlterIndexAliases
[2019-01-16 10:51:01][INFO] horae.py(88): Loaded module: UpdateGoods2es
[2019-01-16 10:51:01][INFO] horae.py(88): Loaded module: Task
[2019-01-16 10:51:01][INFO] horae.py(88): Loaded module: ImportGOCC2bq
[2019-01-16 10:51:01][INFO] horae.py(88): Loaded module: Cron_PubMsg2ES
[2019-01-16 10:51:01][INFO] horae.py(88): Loaded module: ESClusterReroute
[2019-01-16 10:51:01][INFO] horae.py(171): cron task instance key: Cron_PubMsg2ES
[2019-01-16 10:51:01][INFO] horae.py(172): <Cron_PubMsg2ES(Thread-1, initial)> is instancing and starting
[2019-01-16 10:51:01][INFO] Cron_PubMsg2ES.py(59): 0.00 elapaed seconds < 300
[2019-01-16 10:51:04][INFO] horae.py(108): OBJECT_FINALIZE, <class 'ESClusterReroute.ESClusterReroute'> is inherited from Task.Task: True
[2019-01-16 10:51:04][INFO] horae.py(108): OBJECT_FINALIZE, <class 'ImportGOCC2es.ImportGOCC2es'> is inherited from Task.Task: True
[2019-01-16 10:51:04][INFO] horae.py(108): OBJECT_FINALIZE, <class 'Task.Task'> is inherited from Task.Task: True
[2019-01-16 10:51:04][INFO] horae.py(108): OBJECT_FINALIZE, <class 'ImportGOCC2bq.ImportGOCC2bq'> is inherited from Task.Task: True
[2019-01-16 10:51:04][INFO] horae.py(117): task instance key: pull_bucket_ven-custs/OBJECT_FINALIZE/pchome/ImportGOCC2bq
[2019-01-16 10:51:04][INFO] horae.py(125): <ImportGOCC2bq(Thread-2, initial)> is instancing and starting
[2019-01-16 10:51:04][INFO] ImportGOCC2bq.py(51): OBJECT_FINALIZE ven-cust-pchome gocc/update/pchome_gocc_20190116.tar.gz 1547605501359486
[2019-01-16 10:51:04][INFO] horae.py(108): OBJECT_FINALIZE, <class 'Cron_PubMsg2ES.Cron_PubMsg2ES'> is inherited from Task.Task: True
[2019-01-16 10:51:04][INFO] Task.py(68): EnumState.END
[2019-01-16 10:51:04][INFO] horae.py(108): OBJECT_FINALIZE, <class 'ESAlterIndexAliases.ESAlterIndexAliases'> is inherited from Task.Task: True
[2019-01-16 10:51:04][INFO] horae.py(108): OBJECT_FINALIZE, <class 'UpdateGoods2es.UpdateGoods2es'> is inherited from Task.Task: True
[2019-01-16 10:51:04][INFO] horae.py(117): task instance key: pull_bucket_ven-custs/OBJECT_FINALIZE/pchome/UpdateGoods2es
[2019-01-16 10:51:04][INFO] horae.py(125): <UpdateGoods2es(Thread-3, initial)> is instancing and starting
[2019-01-16 10:51:04][INFO] UpdateGoods2es.py(44): OBJECT_FINALIZE ven-cust-pchome gocc/update/pchome_gocc_20190116.tar.gz 1547605501359486
[2019-01-16 10:51:04][INFO] UpdateGoods2es.py(60): rm -rf /tmp/ven-cust-pchome_gocc_update_20190116
[2019-01-16 10:51:04][INFO] UpdateGoods2es.py(64): mkdir -p /tmp/ven-cust-pchome_gocc_update_20190116
[2019-01-16 10:51:04][INFO] UpdateGoods2es.py(68): gsutil cp gs://ven-cust-pchome/gocc/update/pchome_gocc_20190116.tar.gz /tmp/ven-cust-pchome_gocc_update_20190116
[2019-01-16 10:51:07][INFO] horae.py(108): OBJECT_FINALIZE, <class 'ESClusterReroute.ESClusterReroute'> is inherited from Task.Task: True
[2019-01-16 10:51:07][INFO] horae.py(108): OBJECT_FINALIZE, <class 'ImportGOCC2es.ImportGOCC2es'> is inherited from Task.Task: True
[2019-01-16 10:51:07][INFO] horae.py(117): task instance key: pull_bigquery/OBJECT_FINALIZE/pchome/ImportGOCC2es
[2019-01-16 10:51:07][INFO] horae.py(125): <ImportGOCC2es(Thread-4, initial)> is instancing and starting
[2019-01-16 10:51:07][INFO] ImportGOCC2es.py(48): pchome OBJECT_FINALIZE [u'pchome_unima.orderlist_20190114', u'pchome_unima.goodscatecode_20190115', u'pchome_unima.category_20190115', u'pchome_unima.goods_20190115'] 
[2019-01-16 10:51:07][INFO] horae.py(108): OBJECT_FINALIZE, <class 'Task.Task'> is inherited from Task.Task: True
[2019-01-16 10:51:07][INFO] horae.py(108): OBJECT_FINALIZE, <class 'ImportGOCC2bq.ImportGOCC2bq'> is inherited from Task.Task: True
[2019-01-16 10:51:07][INFO] horae.py(108): OBJECT_FINALIZE, <class 'Cron_PubMsg2ES.Cron_PubMsg2ES'> is inherited from Task.Task: True
[2019-01-16 10:51:07][INFO] horae.py(108): OBJECT_FINALIZE, <class 'ESAlterIndexAliases.ESAlterIndexAliases'> is inherited from Task.Task: True
[2019-01-16 10:51:07][INFO] horae.py(108): OBJECT_FINALIZE, <class 'UpdateGoods2es.UpdateGoods2es'> is inherited from Task.Task: True
[2019-01-16 10:51:07][INFO] ImportGOCC2es.py(54): mkdir -p /tmp/gocc2es
[2019-01-16 10:51:07][INFO] ImportGOCC2es.py(60): rm -f /tmp/gocc2es/pchome_*
[2019-01-16 10:51:07][INFO] ImportGOCC2es.py(67): gsutil rm -r -f gs://ven-cust-pchome/tmp/gocc2es
Copying gs://ven-cust-pchome/gocc/update/pchome_gocc_20190116.tar.gz...
/ [0 files][    0.0 B/ 21.7 MiB]                                                CommandException: 1 files/objects could not be removed.
[2019-01-16 10:51:13][INFO] ImportGOCC2es.py(89): bq query -n 0 --replace --use_legacy_sql=False --destination_table=pchome_tmp.gocc2es_category_20190115 SELECT 'pchome' as code_name, SUBSTR(CAST(update_time AS STRING),0,19) as update_time,  * EXCEPT (update_time) FROM pchome_unima.category_20190115
/ [1 files][ 21.7 MiB/ 21.7 MiB]                                                
Operation completed over 1 objects/21.7 MiB.                                     
[2019-01-16 10:51:13][INFO] UpdateGoods2es.py(73): tar -xvf /tmp/ven-cust-pchome_gocc_update_20190116/pchome_gocc_20190116.tar.gz -C /tmp/ven-cust-pchome_gocc_update_20190116
update_data/
update_data/Goods.tsv
[2019-01-16 10:51:14][INFO] UpdateGoods2es.py(80): [u'Goods.tsv']
[2019-01-16 10:51:14][ERROR] UpdateGoods2es.py(205): line 38538 => 14, num of delimiters check failed!
[2019-01-16 10:51:14][INFO] Task.py(68): EnumState.END
BigQuery error in query operation: Error processing job
'pchomeecvenraas:bqjob_r40b21d158090fef6_000001685491e99a_1': Not found: Table
pchomeecvenraas:pchome_unima.category_20190115 was not found in location US
[2019-01-16 10:51:15][INFO] ImportGOCC2es.py(96): bq extract --destination_format=NEWLINE_DELIMITED_JSON "pchome_tmp.gocc2es_category_20190115" gs://ven-cust-pchome/tmp/gocc2es/pchome_category_20190115
BigQuery error in extract operation: Error processing job
'pchomeecvenraas:bqjob_r7d8d84588335f98a_000001685491eeb5_1': Not found: Table
pchomeecvenraas:pchome_tmp.gocc2es_category_20190115 was not found in location
US
[2019-01-16 10:51:17][INFO] ImportGOCC2es.py(101): gsutil cp gs://ven-cust-pchome/tmp/gocc2es/pchome_category_20190115 /tmp/gocc2es
CommandException: No URLs matched: gs://ven-cust-pchome/tmp/gocc2es/pchome_category_20190115
[2019-01-16 10:51:18][ERROR] Task.py(64): [Errno 2] No such file or directory: '/tmp/gocc2es/pchome_category_20190115'
Traceback (most recent call last):
  File "/home/itri/Horae/plugin/Task.py", line 59, in run
    self.exe(self.sub_msg)
  File "/home/itri/Horae/plugin/ImportGOCC2es.py", line 110, in exe
    with io.open(rawFP, 'r', encoding='utf-8') as fi:
IOError: [Errno 2] No such file or directory: '/tmp/gocc2es/pchome_category_20190115'
[2019-01-16 10:51:18][INFO] Task.py(68): EnumState.END
[2019-01-16 10:51:30][INFO] horae.py(88): Loaded module: ImportGOCC2es
[2019-01-16 10:51:30][INFO] horae.py(88): Loaded module: ESAlterIndexAliases
[2019-01-16 10:51:30][INFO] horae.py(88): Loaded module: UpdateGoods2es
[2019-01-16 10:51:30][INFO] horae.py(88): Loaded module: Task
[2019-01-16 10:51:30][INFO] horae.py(88): Loaded module: ImportGOCC2bq
[2019-01-16 10:51:30][INFO] horae.py(88): Loaded module: Cron_PubMsg2ES
[2019-01-16 10:51:30][INFO] horae.py(88): Loaded module: ESClusterReroute
[2019-01-16 10:51:30][INFO] horae.py(108): OBJECT_DELETE, <class 'ESClusterReroute.ESClusterReroute'> is inherited from Task.Task: True
[2019-01-16 10:51:30][INFO] horae.py(108): OBJECT_DELETE, <class 'ImportGOCC2es.ImportGOCC2es'> is inherited from Task.Task: True
[2019-01-16 10:51:30][INFO] horae.py(108): OBJECT_DELETE, <class 'Task.Task'> is inherited from Task.Task: True
[2019-01-16 10:51:30][INFO] horae.py(108): OBJECT_DELETE, <class 'ImportGOCC2bq.ImportGOCC2bq'> is inherited from Task.Task: True
[2019-01-16 10:51:30][INFO] horae.py(108): OBJECT_DELETE, <class 'Cron_PubMsg2ES.Cron_PubMsg2ES'> is inherited from Task.Task: True
[2019-01-16 10:51:30][INFO] horae.py(108): OBJECT_DELETE, <class 'ESAlterIndexAliases.ESAlterIndexAliases'> is inherited from Task.Task: True
[2019-01-16 10:51:30][INFO] horae.py(108): OBJECT_DELETE, <class 'UpdateGoods2es.UpdateGoods2es'> is inherited from Task.Task: True
[2019-01-16 10:52:01][INFO] Cron_PubMsg2ES.py(59): 60.06 elapaed seconds < 300
[2019-01-16 10:52:10][INFO] horae.py(88): Loaded module: ImportGOCC2es
[2019-01-16 10:52:10][INFO] horae.py(88): Loaded module: ESAlterIndexAliases
[2019-01-16 10:52:10][INFO] horae.py(88): Loaded module: UpdateGoods2es
[2019-01-16 10:52:10][INFO] horae.py(88): Loaded module: Task
[2019-01-16 10:52:10][INFO] horae.py(88): Loaded module: ImportGOCC2bq
[2019-01-16 10:52:10][INFO] horae.py(88): Loaded module: Cron_PubMsg2ES
[2019-01-16 10:52:10][INFO] horae.py(88): Loaded module: ESClusterReroute
[2019-01-16 10:52:13][INFO] horae.py(108): OBJECT_FINALIZE, <class 'ESClusterReroute.ESClusterReroute'> is inherited from Task.Task: True
[2019-01-16 10:52:13][INFO] horae.py(108): OBJECT_FINALIZE, <class 'ImportGOCC2es.ImportGOCC2es'> is inherited from Task.Task: True
[2019-01-16 10:52:13][INFO] horae.py(108): OBJECT_FINALIZE, <class 'Task.Task'> is inherited from Task.Task: True
[2019-01-16 10:52:13][INFO] horae.py(108): OBJECT_FINALIZE, <class 'ImportGOCC2bq.ImportGOCC2bq'> is inherited from Task.Task: True
[2019-01-16 10:52:13][INFO] horae.py(117): task instance key: pull_bucket_ven-custs/OBJECT_FINALIZE/pchome/ImportGOCC2bq
[2019-01-16 10:52:13][INFO] horae.py(129): skip message due to task: pull_bucket_ven-custs/OBJECT_FINALIZE/pchome/ImportGOCC2bq is not expired yet, {u'eventTime': u'2019-01-16T02:52:12.668029Z', u'objectId': u'gocc/pchome_gocc_20190115.tar.gz', u'bucketId': u'ven-cust-pchome', u'notificationConfig': u'projects/_/buckets/ven-cust-pchome/notificationConfigs/1', u'overwroteGeneration': u'1547604462492051', u'payloadFormat': u'JSON_API_V1', u'eventType': u'OBJECT_FINALIZE', 'codename': u'pchome', u'objectGeneration': u'1547607132668482'}
[2019-01-16 10:52:13][INFO] horae.py(108): OBJECT_FINALIZE, <class 'Cron_PubMsg2ES.Cron_PubMsg2ES'> is inherited from Task.Task: True
[2019-01-16 10:52:13][INFO] horae.py(108): OBJECT_FINALIZE, <class 'ESAlterIndexAliases.ESAlterIndexAliases'> is inherited from Task.Task: True
[2019-01-16 10:52:13][INFO] horae.py(108): OBJECT_FINALIZE, <class 'UpdateGoods2es.UpdateGoods2es'> is inherited from Task.Task: True
[2019-01-16 10:52:13][INFO] horae.py(117): task instance key: pull_bucket_ven-custs/OBJECT_FINALIZE/pchome/UpdateGoods2es
[2019-01-16 10:52:13][INFO] horae.py(129): skip message due to task: pull_bucket_ven-custs/OBJECT_FINALIZE/pchome/UpdateGoods2es is not expired yet, {u'eventTime': u'2019-01-16T02:52:12.668029Z', u'objectId': u'gocc/pchome_gocc_20190115.tar.gz', u'bucketId': u'ven-cust-pchome', u'notificationConfig': u'projects/_/buckets/ven-cust-pchome/notificationConfigs/1', u'overwroteGeneration': u'1547604462492051', u'payloadFormat': u'JSON_API_V1', u'eventType': u'OBJECT_FINALIZE', 'codename': u'pchome', u'objectGeneration': u'1547607132668482'}
[2019-01-16 10:52:52][INFO] horae.py(88): Loaded module: ImportGOCC2es
[2019-01-16 10:52:52][INFO] horae.py(88): Loaded module: ESAlterIndexAliases
[2019-01-16 10:52:52][INFO] horae.py(88): Loaded module: UpdateGoods2es
[2019-01-16 10:52:52][INFO] horae.py(88): Loaded module: Task
[2019-01-16 10:52:52][INFO] horae.py(88): Loaded module: ImportGOCC2bq
[2019-01-16 10:52:52][INFO] horae.py(88): Loaded module: Cron_PubMsg2ES
[2019-01-16 10:52:52][INFO] horae.py(88): Loaded module: ESClusterReroute
[2019-01-16 10:52:53][INFO] horae.py(108): OBJECT_DELETE, <class 'ESClusterReroute.ESClusterReroute'> is inherited from Task.Task: True
[2019-01-16 10:52:53][INFO] horae.py(108): OBJECT_DELETE, <class 'ImportGOCC2es.ImportGOCC2es'> is inherited from Task.Task: True
[2019-01-16 10:52:53][INFO] horae.py(108): OBJECT_DELETE, <class 'Task.Task'> is inherited from Task.Task: True
[2019-01-16 10:52:53][INFO] horae.py(108): OBJECT_DELETE, <class 'ImportGOCC2bq.ImportGOCC2bq'> is inherited from Task.Task: True
[2019-01-16 10:52:53][INFO] horae.py(108): OBJECT_DELETE, <class 'Cron_PubMsg2ES.Cron_PubMsg2ES'> is inherited from Task.Task: True
[2019-01-16 10:52:53][INFO] horae.py(108): OBJECT_DELETE, <class 'ESAlterIndexAliases.ESAlterIndexAliases'> is inherited from Task.Task: True
[2019-01-16 10:52:53][INFO] horae.py(108): OBJECT_DELETE, <class 'UpdateGoods2es.UpdateGoods2es'> is inherited from Task.Task: True
[2019-01-16 10:53:01][INFO] Cron_PubMsg2ES.py(59): 120.12 elapaed seconds < 300
[2019-01-16 10:53:33][INFO] horae.py(88): Loaded module: ImportGOCC2es
[2019-01-16 10:53:33][INFO] horae.py(88): Loaded module: ESAlterIndexAliases
[2019-01-16 10:53:33][INFO] horae.py(88): Loaded module: UpdateGoods2es
[2019-01-16 10:53:33][INFO] horae.py(88): Loaded module: Task
[2019-01-16 10:53:33][INFO] horae.py(88): Loaded module: ImportGOCC2bq
[2019-01-16 10:53:33][INFO] horae.py(88): Loaded module: Cron_PubMsg2ES
[2019-01-16 10:53:33][INFO] horae.py(88): Loaded module: ESClusterReroute
[2019-01-16 10:54:01][INFO] Cron_PubMsg2ES.py(59): 180.18 elapaed seconds < 300
[2019-01-16 10:54:31][INFO] horae.py(88): Loaded module: ImportGOCC2es
[2019-01-16 10:54:31][INFO] horae.py(88): Loaded module: ESAlterIndexAliases
[2019-01-16 10:54:31][INFO] horae.py(88): Loaded module: UpdateGoods2es
[2019-01-16 10:54:31][INFO] horae.py(88): Loaded module: Task
[2019-01-16 10:54:31][INFO] horae.py(88): Loaded module: ImportGOCC2bq
[2019-01-16 10:54:31][INFO] horae.py(88): Loaded module: Cron_PubMsg2ES
[2019-01-16 10:54:31][INFO] horae.py(88): Loaded module: ESClusterReroute
[2019-01-16 10:55:01][INFO] Cron_PubMsg2ES.py(59): 240.23 elapaed seconds < 300
[2019-01-16 10:55:29][INFO] horae.py(88): Loaded module: ImportGOCC2es
[2019-01-16 10:55:29][INFO] horae.py(88): Loaded module: ESAlterIndexAliases
[2019-01-16 10:55:29][INFO] horae.py(88): Loaded module: UpdateGoods2es
[2019-01-16 10:55:29][INFO] horae.py(88): Loaded module: Task
[2019-01-16 10:55:29][INFO] horae.py(88): Loaded module: ImportGOCC2bq
[2019-01-16 10:55:29][INFO] horae.py(88): Loaded module: Cron_PubMsg2ES
[2019-01-16 10:55:29][INFO] horae.py(88): Loaded module: ESClusterReroute
[2019-01-16 10:56:01][INFO] Cron_PubMsg2ES.py(34): 300.00 < 300.288986921 elapaed seconds
[2019-01-16 10:56:01][INFO] Cron_PubMsg2ES.py(35): publish messages...
[2019-01-16 10:56:01][INFO] Cron_PubMsg2ES.py(53): {'attributes': {'objectIds': '[]', 'eventType': 'CRON_SCHEDULER', 'codename': u'pchome'}}
[2019-01-16 10:56:02][INFO] Task.py(68): EnumState.END
[2019-01-16 10:56:06][INFO] horae.py(108): CRON_SCHEDULER, <class 'ESClusterReroute.ESClusterReroute'> is inherited from Task.Task: True
[2019-01-16 10:56:06][INFO] horae.py(117): task instance key: pull_es-cluster/CRON_SCHEDULER/pchome/ESClusterReroute
[2019-01-16 10:56:06][INFO] horae.py(125): <ESClusterReroute(Thread-5, initial)> is instancing and starting
[2019-01-16 10:56:06][INFO] horae.py(108): CRON_SCHEDULER, <class 'ImportGOCC2es.ImportGOCC2es'> is inherited from Task.Task: True
[2019-01-16 10:56:06][INFO] horae.py(108): CRON_SCHEDULER, <class 'Task.Task'> is inherited from Task.Task: True
[2019-01-16 10:56:06][INFO] horae.py(108): CRON_SCHEDULER, <class 'ImportGOCC2bq.ImportGOCC2bq'> is inherited from Task.Task: True
[2019-01-16 10:56:06][INFO] horae.py(108): CRON_SCHEDULER, <class 'Cron_PubMsg2ES.Cron_PubMsg2ES'> is inherited from Task.Task: True
[2019-01-16 10:56:06][INFO] horae.py(108): CRON_SCHEDULER, <class 'ESAlterIndexAliases.ESAlterIndexAliases'> is inherited from Task.Task: True
[2019-01-16 10:56:06][INFO] horae.py(117): task instance key: pull_es-cluster/CRON_SCHEDULER/pchome/ESAlterIndexAliases
[2019-01-16 10:56:06][INFO] horae.py(125): <ESAlterIndexAliases(Thread-6, initial)> is instancing and starting
[2019-01-16 10:56:06][INFO] ESAlterIndexAliases.py(59): pchome CRON_SCHEDULER [] 
[2019-01-16 10:56:06][INFO] horae.py(108): CRON_SCHEDULER, <class 'UpdateGoods2es.UpdateGoods2es'> is inherited from Task.Task: True
[2019-01-16 10:56:06][INFO] ESClusterReroute.py(47): [westernwall] with status [green]
[2019-01-16 10:56:06][INFO] ESClusterReroute.py(49): great status nothing to do.
[2019-01-16 10:56:06][INFO] Task.py(68): EnumState.END
[2019-01-16 10:56:06][INFO] ESAlterIndexAliases.py(146): pchome_gocc_20190114(idx) = pchome_gocc_20190114(alias), latest indices are equal, awesome +1
[2019-01-16 10:56:06][INFO] ESAlterIndexAliases.py(162): [pchome_gocc] has 3 indices and the latest alias on [pchome_gocc_20190114], <= 3, which does not need to purge yet.
[2019-01-16 10:56:06][INFO] ESAlterIndexAliases.py(86): pchome_oua_20190116(idx) = pchome_oua_20190116(alias), latest indices are equal, awesome +1
[2019-01-16 10:56:06][INFO] ESAlterIndexAliases.py(162): [pchome_oua] has 14 indices and the latest alias on [pchome_oua_20190116], <= 14, which does not need to purge yet.
[2019-01-16 10:56:06][INFO] ESAlterIndexAliases.py(86): pchome_opp_20190116(idx) = pchome_opp_20190116(alias), latest indices are equal, awesome +1
[2019-01-16 10:56:06][INFO] ESAlterIndexAliases.py(162): [pchome_opp] has 14 indices and the latest alias on [pchome_opp_20190116], <= 14, which does not need to purge yet.
[2019-01-16 10:56:06][INFO] ESAlterIndexAliases.py(99): pchome_mod_20190116(idx) <> pchome_mod_20190115(alias), latest indices is not equal
[2019-01-16 10:56:06][INFO] ESAlterIndexAliases.py(100): let's sync the alias to the latest index ...
[2019-01-16 10:56:09][INFO] horae.py(88): Loaded module: ImportGOCC2es
[2019-01-16 10:56:09][INFO] horae.py(88): Loaded module: ESAlterIndexAliases
[2019-01-16 10:56:09][INFO] horae.py(88): Loaded module: UpdateGoods2es
[2019-01-16 10:56:09][INFO] horae.py(88): Loaded module: Task
[2019-01-16 10:56:09][INFO] horae.py(88): Loaded module: ImportGOCC2bq
[2019-01-16 10:56:09][INFO] horae.py(88): Loaded module: Cron_PubMsg2ES
[2019-01-16 10:56:09][INFO] horae.py(88): Loaded module: ESClusterReroute
[2019-01-16 10:56:36][INFO] ESAlterIndexAliases.py(113): http://es-node-01:9200/pchome_mod_20190116/_count is stable with 42,010,465 docs.
[2019-01-16 10:56:36][INFO] ESAlterIndexAliases.py(126): GlobalTP is available in pchome_mod_20190116, hits.total: 1
[2019-01-16 10:56:36][WARNING] ESAlterIndexAliases.py(144): 19587485.0/42010465.0= 0.466252515891 < 0.98 unable to alter alias due to invalid ratio.
[2019-01-16 10:56:36][INFO] ESAlterIndexAliases.py(162): [pchome_mod] has 3 indices and the latest alias on [pchome_mod_20190115], <= 3, which does not need to purge yet.
[2019-01-16 10:56:36][INFO] Task.py(68): EnumState.END
[2019-01-16 10:57:08][INFO] horae.py(88): Loaded module: ImportGOCC2es
[2019-01-16 10:57:08][INFO] horae.py(88): Loaded module: ESAlterIndexAliases
[2019-01-16 10:57:08][INFO] horae.py(88): Loaded module: UpdateGoods2es
[2019-01-16 10:57:08][INFO] horae.py(88): Loaded module: Task
[2019-01-16 10:57:08][INFO] horae.py(88): Loaded module: ImportGOCC2bq
[2019-01-16 10:57:08][INFO] horae.py(88): Loaded module: Cron_PubMsg2ES
[2019-01-16 10:57:08][INFO] horae.py(88): Loaded module: ESClusterReroute
[2019-01-16 10:57:08][INFO] horae.py(159): del task with key: pull_es-cluster/CRON_SCHEDULER/pchome/ESClusterReroute
[2019-01-16 10:57:08][INFO] horae.py(159): del task with key: Cron_PubMsg2ES
[2019-01-16 10:57:08][INFO] horae.py(171): cron task instance key: Cron_PubMsg2ES
[2019-01-16 10:57:08][INFO] horae.py(172): <Cron_PubMsg2ES(Thread-7, initial)> is instancing and starting
[2019-01-16 10:57:08][INFO] Cron_PubMsg2ES.py(59): 0.00 elapaed seconds < 300
[2019-01-16 10:58:05][INFO] horae.py(88): Loaded module: ImportGOCC2es
[2019-01-16 10:58:05][INFO] horae.py(88): Loaded module: ESAlterIndexAliases
[2019-01-16 10:58:05][INFO] horae.py(88): Loaded module: UpdateGoods2es
[2019-01-16 10:58:05][INFO] horae.py(88): Loaded module: Task
[2019-01-16 10:58:05][INFO] horae.py(88): Loaded module: ImportGOCC2bq
[2019-01-16 10:58:05][INFO] horae.py(88): Loaded module: Cron_PubMsg2ES
[2019-01-16 10:58:05][INFO] horae.py(88): Loaded module: ESClusterReroute
[2019-01-16 10:58:05][INFO] horae.py(159): del task with key: pull_es-cluster/CRON_SCHEDULER/pchome/ESAlterIndexAliases
[2019-01-16 10:58:08][INFO] Cron_PubMsg2ES.py(59): 60.06 elapaed seconds < 300
[2019-01-16 10:59:04][INFO] horae.py(88): Loaded module: ImportGOCC2es
[2019-01-16 10:59:04][INFO] horae.py(88): Loaded module: ESAlterIndexAliases
[2019-01-16 10:59:04][INFO] horae.py(88): Loaded module: UpdateGoods2es
[2019-01-16 10:59:04][INFO] horae.py(88): Loaded module: Task
[2019-01-16 10:59:04][INFO] horae.py(88): Loaded module: ImportGOCC2bq
[2019-01-16 10:59:04][INFO] horae.py(88): Loaded module: Cron_PubMsg2ES
[2019-01-16 10:59:04][INFO] horae.py(88): Loaded module: ESClusterReroute
[2019-01-16 10:59:08][INFO] Cron_PubMsg2ES.py(59): 120.12 elapaed seconds < 300
[2019-01-16 11:00:03][INFO] horae.py(88): Loaded module: ImportGOCC2es
[2019-01-16 11:00:03][INFO] horae.py(88): Loaded module: ESAlterIndexAliases
[2019-01-16 11:00:03][INFO] horae.py(88): Loaded module: UpdateGoods2es
[2019-01-16 11:00:03][INFO] horae.py(88): Loaded module: Task
[2019-01-16 11:00:03][INFO] horae.py(88): Loaded module: ImportGOCC2bq
[2019-01-16 11:00:03][INFO] horae.py(88): Loaded module: Cron_PubMsg2ES
[2019-01-16 11:00:03][INFO] horae.py(88): Loaded module: ESClusterReroute
[2019-01-16 11:00:08][INFO] Cron_PubMsg2ES.py(59): 180.18 elapaed seconds < 300
[2019-01-16 11:01:01][INFO] horae.py(88): Loaded module: ImportGOCC2es
[2019-01-16 11:01:01][INFO] horae.py(88): Loaded module: ESAlterIndexAliases
[2019-01-16 11:01:01][INFO] horae.py(88): Loaded module: UpdateGoods2es
[2019-01-16 11:01:01][INFO] horae.py(88): Loaded module: Task
[2019-01-16 11:01:01][INFO] horae.py(88): Loaded module: ImportGOCC2bq
[2019-01-16 11:01:01][INFO] horae.py(88): Loaded module: Cron_PubMsg2ES
[2019-01-16 11:01:01][INFO] horae.py(88): Loaded module: ESClusterReroute
[2019-01-16 11:01:08][INFO] Cron_PubMsg2ES.py(59): 240.21 elapaed seconds < 300
[2019-01-16 11:01:59][INFO] horae.py(88): Loaded module: ImportGOCC2es
[2019-01-16 11:01:59][INFO] horae.py(88): Loaded module: ESAlterIndexAliases
[2019-01-16 11:01:59][INFO] horae.py(88): Loaded module: UpdateGoods2es
[2019-01-16 11:01:59][INFO] horae.py(88): Loaded module: Task
[2019-01-16 11:01:59][INFO] horae.py(88): Loaded module: ImportGOCC2bq
[2019-01-16 11:01:59][INFO] horae.py(88): Loaded module: Cron_PubMsg2ES
[2019-01-16 11:01:59][INFO] horae.py(88): Loaded module: ESClusterReroute
[2019-01-16 11:01:59][INFO] horae.py(159): del task with key: pull_bucket_ven-custs/OBJECT_FINALIZE/pchome/UpdateGoods2es
[2019-01-16 11:01:59][INFO] horae.py(159): del task with key: pull_bigquery/OBJECT_FINALIZE/pchome/ImportGOCC2es
[2019-01-16 11:02:08][INFO] Cron_PubMsg2ES.py(34): 300.00 < 300.270622015 elapaed seconds
[2019-01-16 11:02:08][INFO] Cron_PubMsg2ES.py(35): publish messages...
[2019-01-16 11:02:08][INFO] Cron_PubMsg2ES.py(53): {'attributes': {'objectIds': '[]', 'eventType': 'CRON_SCHEDULER', 'codename': u'pchome'}}
[2019-01-16 11:02:08][INFO] Task.py(68): EnumState.END
[2019-01-16 11:02:39][INFO] horae.py(108): CRON_SCHEDULER, <class 'ESClusterReroute.ESClusterReroute'> is inherited from Task.Task: True
[2019-01-16 11:02:39][INFO] horae.py(117): task instance key: pull_es-cluster/CRON_SCHEDULER/pchome/ESClusterReroute
[2019-01-16 11:02:39][INFO] horae.py(125): <ESClusterReroute(Thread-8, initial)> is instancing and starting
[2019-01-16 11:02:39][INFO] horae.py(108): CRON_SCHEDULER, <class 'ImportGOCC2es.ImportGOCC2es'> is inherited from Task.Task: True
[2019-01-16 11:02:39][INFO] horae.py(108): CRON_SCHEDULER, <class 'Task.Task'> is inherited from Task.Task: True
[2019-01-16 11:02:39][INFO] horae.py(108): CRON_SCHEDULER, <class 'ImportGOCC2bq.ImportGOCC2bq'> is inherited from Task.Task: True
[2019-01-16 11:02:39][INFO] horae.py(108): CRON_SCHEDULER, <class 'Cron_PubMsg2ES.Cron_PubMsg2ES'> is inherited from Task.Task: True
[2019-01-16 11:02:39][INFO] horae.py(108): CRON_SCHEDULER, <class 'ESAlterIndexAliases.ESAlterIndexAliases'> is inherited from Task.Task: True
[2019-01-16 11:02:39][INFO] horae.py(117): task instance key: pull_es-cluster/CRON_SCHEDULER/pchome/ESAlterIndexAliases
[2019-01-16 11:02:39][INFO] horae.py(125): <ESAlterIndexAliases(Thread-9, initial)> is instancing and starting
[2019-01-16 11:02:39][INFO] horae.py(108): CRON_SCHEDULER, <class 'UpdateGoods2es.UpdateGoods2es'> is inherited from Task.Task: True
[2019-01-16 11:02:39][INFO] ESAlterIndexAliases.py(59): pchome CRON_SCHEDULER [] 
[2019-01-16 11:02:39][INFO] ESClusterReroute.py(47): [westernwall] with status [green]
[2019-01-16 11:02:39][INFO] ESAlterIndexAliases.py(146): pchome_gocc_20190114(idx) = pchome_gocc_20190114(alias), latest indices are equal, awesome +1
[2019-01-16 11:02:39][INFO] ESClusterReroute.py(49): great status nothing to do.
[2019-01-16 11:02:39][INFO] Task.py(68): EnumState.END
[2019-01-16 11:02:39][INFO] ESAlterIndexAliases.py(162): [pchome_gocc] has 3 indices and the latest alias on [pchome_gocc_20190114], <= 3, which does not need to purge yet.
[2019-01-16 11:02:39][INFO] ESAlterIndexAliases.py(86): pchome_oua_20190116(idx) = pchome_oua_20190116(alias), latest indices are equal, awesome +1
[2019-01-16 11:02:39][INFO] ESAlterIndexAliases.py(162): [pchome_oua] has 14 indices and the latest alias on [pchome_oua_20190116], <= 14, which does not need to purge yet.
[2019-01-16 11:02:39][INFO] ESAlterIndexAliases.py(86): pchome_opp_20190116(idx) = pchome_opp_20190116(alias), latest indices are equal, awesome +1
[2019-01-16 11:02:39][INFO] ESAlterIndexAliases.py(162): [pchome_opp] has 14 indices and the latest alias on [pchome_opp_20190116], <= 14, which does not need to purge yet.
[2019-01-16 11:02:39][INFO] ESAlterIndexAliases.py(99): pchome_mod_20190116(idx) <> pchome_mod_20190115(alias), latest indices is not equal
[2019-01-16 11:02:39][INFO] ESAlterIndexAliases.py(100): let's sync the alias to the latest index ...
[2019-01-16 11:02:42][INFO] horae.py(88): Loaded module: ImportGOCC2es
[2019-01-16 11:02:42][INFO] horae.py(88): Loaded module: ESAlterIndexAliases
[2019-01-16 11:02:42][INFO] horae.py(88): Loaded module: UpdateGoods2es
[2019-01-16 11:02:42][INFO] horae.py(88): Loaded module: Task
[2019-01-16 11:02:42][INFO] horae.py(88): Loaded module: ImportGOCC2bq
[2019-01-16 11:02:42][INFO] horae.py(88): Loaded module: Cron_PubMsg2ES
[2019-01-16 11:02:42][INFO] horae.py(88): Loaded module: ESClusterReroute
[2019-01-16 11:02:42][INFO] horae.py(159): del task with key: Cron_PubMsg2ES
[2019-01-16 11:02:42][INFO] horae.py(171): cron task instance key: Cron_PubMsg2ES
[2019-01-16 11:02:42][INFO] horae.py(172): <Cron_PubMsg2ES(Thread-10, initial)> is instancing and starting
[2019-01-16 11:02:42][INFO] Cron_PubMsg2ES.py(59): 0.00 elapaed seconds < 300
[2019-01-16 11:02:42][INFO] horae.py(108): OBJECT_DELETE, <class 'ESClusterReroute.ESClusterReroute'> is inherited from Task.Task: True
[2019-01-16 11:02:42][INFO] horae.py(108): OBJECT_DELETE, <class 'ImportGOCC2es.ImportGOCC2es'> is inherited from Task.Task: True
[2019-01-16 11:02:42][INFO] horae.py(108): OBJECT_DELETE, <class 'Task.Task'> is inherited from Task.Task: True
[2019-01-16 11:02:42][INFO] horae.py(108): OBJECT_DELETE, <class 'ImportGOCC2bq.ImportGOCC2bq'> is inherited from Task.Task: True
[2019-01-16 11:02:42][INFO] horae.py(108): OBJECT_DELETE, <class 'Cron_PubMsg2ES.Cron_PubMsg2ES'> is inherited from Task.Task: True
[2019-01-16 11:02:42][INFO] horae.py(108): OBJECT_DELETE, <class 'ESAlterIndexAliases.ESAlterIndexAliases'> is inherited from Task.Task: True
[2019-01-16 11:02:42][INFO] horae.py(108): OBJECT_DELETE, <class 'UpdateGoods2es.UpdateGoods2es'> is inherited from Task.Task: True
[2019-01-16 11:03:09][INFO] ESAlterIndexAliases.py(113): http://es-node-01:9200/pchome_mod_20190116/_count is stable with 42,010,465 docs.
[2019-01-16 11:03:09][INFO] ESAlterIndexAliases.py(126): GlobalTP is available in pchome_mod_20190116, hits.total: 1
[2019-01-16 11:03:09][WARNING] ESAlterIndexAliases.py(144): 19587485.0/42010465.0= 0.466252515891 < 0.98 unable to alter alias due to invalid ratio.
[2019-01-16 11:03:09][INFO] ESAlterIndexAliases.py(162): [pchome_mod] has 3 indices and the latest alias on [pchome_mod_20190115], <= 3, which does not need to purge yet.
[2019-01-16 11:03:09][INFO] Task.py(68): EnumState.END
[2019-01-16 11:03:22][INFO] horae.py(88): Loaded module: ImportGOCC2es
[2019-01-16 11:03:22][INFO] horae.py(88): Loaded module: ESAlterIndexAliases
[2019-01-16 11:03:22][INFO] horae.py(88): Loaded module: UpdateGoods2es
[2019-01-16 11:03:22][INFO] horae.py(88): Loaded module: Task
[2019-01-16 11:03:22][INFO] horae.py(88): Loaded module: ImportGOCC2bq
[2019-01-16 11:03:22][INFO] horae.py(88): Loaded module: Cron_PubMsg2ES
[2019-01-16 11:03:22][INFO] horae.py(88): Loaded module: ESClusterReroute
[2019-01-16 11:03:22][INFO] horae.py(108): OBJECT_FINALIZE, <class 'ESClusterReroute.ESClusterReroute'> is inherited from Task.Task: True
[2019-01-16 11:03:22][INFO] horae.py(108): OBJECT_FINALIZE, <class 'ImportGOCC2es.ImportGOCC2es'> is inherited from Task.Task: True
[2019-01-16 11:03:22][INFO] horae.py(108): OBJECT_FINALIZE, <class 'Task.Task'> is inherited from Task.Task: True
[2019-01-16 11:03:22][INFO] horae.py(108): OBJECT_FINALIZE, <class 'ImportGOCC2bq.ImportGOCC2bq'> is inherited from Task.Task: True
[2019-01-16 11:03:22][INFO] horae.py(117): task instance key: pull_bucket_ven-custs/OBJECT_FINALIZE/pchome/ImportGOCC2bq
[2019-01-16 11:03:22][INFO] horae.py(129): skip message due to task: pull_bucket_ven-custs/OBJECT_FINALIZE/pchome/ImportGOCC2bq is not expired yet, {u'eventTime': u'2019-01-16T03:02:27.159054Z', u'objectId': u'gocc/pchome_gocc_20190115.tar.gz', u'eventType': u'OBJECT_FINALIZE', u'notificationConfig': u'projects/_/buckets/ven-cust-pchome/notificationConfigs/1', u'overwroteGeneration': u'1547607132668482', u'payloadFormat': u'JSON_API_V1', u'bucketId': u'ven-cust-pchome', 'codename': u'pchome', u'objectGeneration': u'1547607747160592'}
[2019-01-16 11:03:22][INFO] horae.py(108): OBJECT_FINALIZE, <class 'Cron_PubMsg2ES.Cron_PubMsg2ES'> is inherited from Task.Task: True
[2019-01-16 11:03:22][INFO] horae.py(108): OBJECT_FINALIZE, <class 'ESAlterIndexAliases.ESAlterIndexAliases'> is inherited from Task.Task: True
[2019-01-16 11:03:22][INFO] horae.py(108): OBJECT_FINALIZE, <class 'UpdateGoods2es.UpdateGoods2es'> is inherited from Task.Task: True
[2019-01-16 11:03:22][INFO] horae.py(117): task instance key: pull_bucket_ven-custs/OBJECT_FINALIZE/pchome/UpdateGoods2es
[2019-01-16 11:03:22][INFO] horae.py(125): <UpdateGoods2es(Thread-11, initial)> is instancing and starting
[2019-01-16 11:03:22][INFO] UpdateGoods2es.py(44): OBJECT_FINALIZE ven-cust-pchome gocc/pchome_gocc_20190115.tar.gz 1547607747160592
[2019-01-16 11:03:22][INFO] Task.py(68): EnumState.END
[2019-01-16 11:03:42][INFO] Cron_PubMsg2ES.py(59): 60.06 elapaed seconds < 300
[2019-01-16 11:04:03][INFO] horae.py(88): Loaded module: ImportGOCC2es
[2019-01-16 11:04:03][INFO] horae.py(88): Loaded module: ESAlterIndexAliases
[2019-01-16 11:04:03][INFO] horae.py(88): Loaded module: UpdateGoods2es
[2019-01-16 11:04:03][INFO] horae.py(88): Loaded module: Task
[2019-01-16 11:04:03][INFO] horae.py(88): Loaded module: ImportGOCC2bq
[2019-01-16 11:04:03][INFO] horae.py(88): Loaded module: Cron_PubMsg2ES
[2019-01-16 11:04:03][INFO] horae.py(88): Loaded module: ESClusterReroute
[2019-01-16 11:04:03][INFO] horae.py(159): del task with key: pull_es-cluster/CRON_SCHEDULER/pchome/ESClusterReroute
